---
title: "HW 07 - Smoking while pregnant"
subtitle: Individual assignment
date: 'Due: March 27 at 23:59'
output: html_document
---


<style>
.column-left{
  float: left;
  width: 60%;
  text-align: left;
}
.column-right-small{
  float: right;
  width: 30%;
  text-align: right;
  padding-left: 10px;
  font-size:10px;
}

.column-right-large{
  float: right;
  width: 40%;
  text-align: left;
  padding-left: 10px;
}

.column-full{
  float: none;
  width: 100%;
  text-align: centre;
}


.column-full-left{
  float: none;
  width: 100%;
  text-align: left;
}

.center {
  height: 200px;
  border: 0px;
  text-align: center;
}


.RUsers {
  padding: 1em;
  background: aliceblue;
  color: black;
}


.SPSS {
  padding: 1em;
  background: whitesmoke;
  color: black;
}

</style>




```{r setup, echo=FALSE, message=FALSE, warning=FALSE}


knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
library(tidyverse)
library(broom)
library(modelsummary)
library(gridExtra)
# library(lubridate)
# library(scales)
# library(DT)
# library(unvotes)

# United Nations



```



<div class="column-right-small">

```{r auction, echo=FALSE, fig.align="right"}
knitr::include_graphics("images/smoking.jpg")
```

Maternal smoking during pregnancy could cause biological aging, influencing fetal growth
</div>


<div class="column-full-left">



In 2004, the state of North Carolina released a large data set containing information on births recorded in this state.
This data set is useful to researchers studying the relation between habits and practices of expectant mothers and the birth of their children. We will work with a random sample of observations from this data set.

# Learning goals

-   Constructing confidence intervals
-   Conducting hypothesis tests
-   Interpreting confidence intervals and results of hypothesis tests in context of the data


## Packages

We'll use the **tidyverse** package for much of the data wrangling and visualisation, the **tidymodels** package for inference, and the data lives in the **dsbox** package.
These packages are already installed for you.
You can load them by running the following in your Console:

```{r}
library(tidyverse) 
# library(tidymodels)
library(openintro)
```

## Data

The data can be found in the **dsbox** package, and it's called `ncbirths`.
Since the dataset is distributed with the package, we don't need to load it separately; it becomes available to us when we load the package.
You can find out more about the dataset by inspecting its documentation, which you can access by running `?ncbirths` in the Console or using the Help menu in RStudio to search for `ncbirths`.
You can also find this information [here](https://rstudio-education.github.io/dsbox/reference/ncbirths.html).

# Set a seed!

In this lab we'll be generating random samples.
The last thing you want is those samples to change every time you knit your document.
So, you should set a seed.
There's an R chunk in your R Markdown file set aside for this.
Locate it and add a seed.
Make sure all members in a team are using the same seed so that you don't get merge conflicts and your results match up for the narratives.

# Exercises

1.  What are the cases in this data set? How many cases are there in our sample?

The first step in the analysis of a new dataset is getting acquainted with the data.
Make summaries of the variables in your dataset, determine which variables are categorical and which are numerical.
For numerical variables, are there outliers?
If you aren't sure or want to take a closer look at the data, make a graph.

## Baby weights

A 1995 study suggests that average weight of Caucasian babies born in the US is 3,369 grams (7.43 pounds).[^lab-12-inference-smoking-1]
In this dataset we only have information on mother's race, so we will make the simplifying assumption that babies of Caucasian mothers are also Caucasian, i.e. `whitemom = "white"`.

We want to evaluate whether the average weight of Caucasian babies has changed since 1995.

Our null hypothesis should state "there is nothing going on", i.e. no change since 1995: $H_0: \mu = 7.43~pounds$.

Our alternative hypothesis should reflect the research question, i.e. some change since 1995.
Since the research question doesn't state a direction for the change, we use a two sided alternative hypothesis: $H_A: \mu \ne 7.43~pounds$.

3.  Create a filtered data frame called `ncbirths_white` that contain data only from white mothers.
    Then, calculate the mean of the weights of their babies.

4.  Are the conditions necessary for conducting simulation based inference satisfied?
    Explain your reasoning.

Let's discuss how this test would work.
Our goal is to simulate a null distribution of sample means that is centred at the null value of 7.43 pounds.
In order to do so, we

-   take a bootstrap sample of from the original sample,
-   calculate this bootstrap sample's mean,
-   repeat these two steps a large number of times to create a bootstrap distribution of means centred at the observed sample mean,
-   shift this distribution to be centred at the null value by subtracting / adding X to all bootstrap mean (X = difference between mean of bootstrap distribution and null value), and
-   calculate the p-value as the proportion of bootstrap samples that yielded a sample mean at least as extreme as the observed sample mean.

5.  Run the appropriate hypothesis test, visualize the null distribution, calculate the p-value, and interpret the results in context of the data and the hypothesis test.

## Baby weight vs. smoking

Consider the possible relationship between a mother's smoking habit and the weight of her baby.
Plotting the data is a useful first step because it helps us quickly visualize trends, identify strong associations, and develop research questions.

6.  Make side-by-side boxplots displaying the relationship between `habit` and `weight`.
    What does the plot highlight about the relationship between these two variables?

7.  Before moving forward, save a version of the dataset omitting observations where there are NAs for `habit`.
    You can call this version `ncbirths_habitgiven`.

The box plots show how the medians of the two distributions compare, but we can also compare the means of the distributions using the following to first group the data by the `habit` variable, and then calculate the mean `weight` in these groups using.

```{r habit-means, eval=FALSE}
ncbirths_habitgiven %>%
  group_by(habit) %>%
  summarise(mean_weight = mean(weight))
```

There is an observed difference, but is this difference statistically significant?
In order to answer this question we will conduct a hypothesis test .

7.  Write the hypotheses for testing if the average weights of babies born to smoking and non-smoking mothers are different.

8.  Are the conditions necessary for conducting simulation based inference satisfied?
    Explain your reasoning.

9.  Run the appropriate hypothesis test, calculate the p-value, and interpret the results in context of the data and the hypothesis test.

10. Construct a 95% confidence interval for the difference between the average weights of babies born to smoking and non-smoking mothers.

## Baby weight vs. mother's age

In this portion of the analysis we focus on two variables.
The first one is `maturemom`.

11. First, a non-inference task: Determine the age cutoff for younger and mature mothers. Use a method of your choice, and explain how your method works.

The other variable of interest is `lowbirthweight`.

12. Conduct a hypothesis test evaluating whether the proportion of low birth weight babies is higher for mature mothers. State the hypotheses, verify the conditions, run the test and calculate the p-value, and state your conclusion in context of the research question. Use $\alpha = 0.05$. If you find a significant difference, construct a confidence interval, at the equivalent level to the hypothesis test, for the difference between the proportions of low birth weight babies between mature and younger mothers, and interpret this interval in context of the data.

[^lab-12-inference-smoking-1]: Wen, Shi Wu, Michael S. Kramer, and Robert H. Usher.
    "Comparison of birth weight distributions between Chinese and Caucasian infants." American Journal of Epidemiology 141.12 (1995): 1177-1187.


üß∂ *Knit frequently, knit often. Look at your report, make sure it looks neat, professional and tidy.*

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

</div>


# Numeric literacy: A house [divided](https://en.wikipedia.org/wiki/Lincoln%27s_House_Divided_Speech)?

Most data on the Russian home front are unreliable. The government has limited freedom of speech and arrested thousands of protesters. A few polls do show support for the war. But the reliability of such polls is moot. The Kremlin has criminalised statements about the war that it deems false. But they still reveal political cleavages and trends over time. One poll found that being young or female, living in a big city, having a degree and not watching tv predicted anti-war views. Support may also be waning. In surveys of internet users in Moscow run by [Alexei Navalny](https://en.wikipedia.org/wiki/Alexei_Navalny), an opposition leader, the share of people blaming Russia surged during the war‚Äôs first week.

Another rich source of data is social media. A team at the University of Vermont has built a measure of sentiment on these sites, using frequencies of various words and ratings of the joy or sadness they convey. Applied to Russian-language Twitter, it accurately detects happy moments like New Year‚Äôs Eve. And its fluctuations over time line up with those of a conventional poll run by Gallup, an American firm.

This measure finds that Mr Putin has sent Twitter users into deep despair. Mentions of ‚Äúwar‚Äù, frowned upon by the Kremlin, have risen sharply, as have ‚Äúscary‚Äù, ‚Äúashamed‚Äù and ‚Äúhorror‚Äù. Overall, posters‚Äô mood has worsened eight times more than at the start of the covid-19 pandemic. Based on past trends, this implies a one-point dip on Gallup‚Äôs one-to-ten happiness scale. 

Sources: The Economist, Computational Story Lab; [dorussianswantwar.com](https://www.dorussianswantwar.com/en); [hedonometer.org](hedonometer.org); Qualitas; Twitter; VTsIOM


Please study the graph below carefully, read the explanation and answer the questions below: 


<div class="column-full">

```{r numeric-lit, echo=FALSE, fig.align="center", fig.cap="", out.width=800}
knitr::include_graphics("images/russia-happiness.png")
```
*Above:* Happiness score of tweets in Russian, average per day. *Below:* Difference in frequency of words in Russian-language posts on Twitter, % Between day Russian troops entered Crimea in 2014 and start of current war in Ukraine, top 50 words
</div>



### Questions: 

1. What do you notice?
    
    After studying the graph and reading the text, what details do you see in the graph that are unusual or surprising? Looking at it carefully and paying attention to detail, what can you get out of the graph that is not necessarily obvious at first glance
    
2. What do you wonder? 
    
    Try to formulate a question, related to the graph, something that you would genuinely like to know. Please state your question clearly: as in a statement that ends with a question mark. 
    
3. How does this relate to you and your community?

    Think of something that makes this graph relate to you personally or to your community, however defined. Make sure that you *do not* talk about something that relates the graph to everyone, no matter who they are, but only to members of *your* community, something *specific* that does not related to other communities. This is your opportunity to be creative!  
    
4. What‚Äôs going on in this graph? Write a catchy headline that captures the graph‚Äôs main idea.


